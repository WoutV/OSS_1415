<%
   size_metric = widget_properties['sizeMetric']
   color_metric = widget_properties['colorMetric']

   filter = MeasureFilter.new
   filter.set_criteria_value(:baseId, @resource.id)
   filter.set_criteria_value(:display, 'treemap')
   filter.set_criteria_value(:tmSize, size_metric.key) if size_metric
   filter.set_criteria_value(:tmColor, color_metric.key) if color_metric
   filter.set_criteria_value(:tmHeight, widget_properties['heightInPercents'])
   filter.execute(self, :user => current_user)
%>
<%= render :partial => "measures/display_treemap", :locals => {:edit_mode => false, :widget_id => widget.id, :filter => filter} %>
